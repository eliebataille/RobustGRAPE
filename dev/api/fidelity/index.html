<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fidelity Calculations · RobustGRAPE.jl</title><meta name="title" content="Fidelity Calculations · RobustGRAPE.jl"/><meta property="og:title" content="Fidelity Calculations · RobustGRAPE.jl"/><meta property="twitter:title" content="Fidelity Calculations · RobustGRAPE.jl"/><meta name="description" content="Documentation for RobustGRAPE.jl."/><meta property="og:description" content="Documentation for RobustGRAPE.jl."/><meta property="twitter:description" content="Documentation for RobustGRAPE.jl."/><meta property="og:url" content="https://srtweezer.github.io/RobustGRAPE/api/fidelity/"/><meta property="twitter:url" content="https://srtweezer.github.io/RobustGRAPE/api/fidelity/"/><link rel="canonical" href="https://srtweezer.github.io/RobustGRAPE/api/fidelity/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../guide/introduction/">Introduction</a></li><li><a class="tocitem" href="../../guide/getting-started/">Getting Started</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../unitary/">Unitary Calculations</a></li><li class="is-active"><a class="tocitem" href>Fidelity Calculations</a><ul class="internal"><li><a class="tocitem" href="#Fidelity-Functions"><span>Fidelity Functions</span></a></li><li><a class="tocitem" href="#Error-Analysis"><span>Error Analysis</span></a></li></ul></li><li><a class="tocitem" href="../regularization/">Regularization</a></li><li><a class="tocitem" href="../rydberg/">Rydberg Tools</a></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Fidelity Calculations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fidelity Calculations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/srtweezer/RobustGRAPE" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/srtweezer/RobustGRAPE/blob/https://github.com/srtweezer/RobustGRAPE/docs/src/api/fidelity.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fidelity-Calculations"><a class="docs-heading-anchor" href="#Fidelity-Calculations">Fidelity Calculations</a><a id="Fidelity-Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Fidelity-Calculations" title="Permalink"></a></h1><h2 id="Fidelity-Functions"><a class="docs-heading-anchor" href="#Fidelity-Functions">Fidelity Functions</a><a id="Fidelity-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Fidelity-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RobustGRAPE.calculate_fidelity_and_derivatives" href="#RobustGRAPE.calculate_fidelity_and_derivatives"><code>RobustGRAPE.calculate_fidelity_and_derivatives</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_fidelity_and_derivatives(fidelity_problem::FidelityRobustGRAPEProblem, x::Vector{&lt;:Real})</code></pre><p>Calculate the fidelity between the evolved unitary and target unitary, along with its derivatives.</p><p><strong>Arguments</strong></p><ul><li><code>fidelity_problem::FidelityRobustGRAPEProblem</code>: The fidelity problem definition</li><li><code>x::Vector{&lt;:Real}</code>: The optimization vector containing control parameters and additional parameters</li></ul><p><strong>Returns</strong></p><p>A tuple with:</p><ul><li><code>F</code>: The fidelity value</li><li><code>F_dx_tot</code>: Combined derivatives with respect to all control parameters (both main and additional)</li><li><code>F_d2err</code>: Second derivatives with respect to error sources</li><li><code>F_d2err_dx_tot</code>: Combined mixed derivatives for error and all control parameters</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/srtweezer/RobustGRAPE/blob/8de327b031e20102196b4646e4e74ba724094e52/src/FidelityCalculations.jl#L3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RobustGRAPE.optimize_fidelity_and_error_sources" href="#RobustGRAPE.optimize_fidelity_and_error_sources"><code>RobustGRAPE.optimize_fidelity_and_error_sources</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_fidelity_and_error_sources(fidelity_problem::FidelityRobustGRAPEProblem, fidelity_parameters::FidelityRobustGRAPEParameters)</code></pre><p>Optimizes quantum control pulses while considering robustness against error sources.</p><p>This is a high-level wrapper around Optim.optimize that:</p><ol><li>Combines fidelity optimization with error robustness</li><li>Applies regularization to the control pulses</li><li>Handles caching to avoid redundant calculations</li></ol><p><strong>Parameters</strong></p><ul><li><code>fidelity_problem::FidelityRobustGRAPEProblem</code>: Problem definition including the Hamiltonian, target unitary, and error sources</li><li><code>fidelity_parameters::FidelityRobustGRAPEParameters</code>: Optimization parameters including initial values, regularization, and solver configuration</li></ul><p><strong>Returns</strong></p><ul><li>An Optim.OptimizationResults object containing the optimization status, parameters, and diagnostics</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Create a problem definition
problem = FidelityRobustGRAPEProblem(...)

# Create optimization parameters
params = FidelityRobustGRAPEParameters(
    x_initial = initial_x,
    regularization_functions = [regularization_cost_phase],
    regularization_coeff1 = [1e-6],
    regularization_coeff2 = [1e-6],
    error_source_coeff = [1e-3],
    iterations = 1000,
    solver_algorithm = LBFGS()
)

# Run the optimization
result = optimize_fidelity_and_error_sources(problem, params)

# Get optimized parameters
optimal_params = Optim.minimizer(result)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/srtweezer/RobustGRAPE/blob/8de327b031e20102196b4646e4e74ba724094e52/src/FidelityCalculations.jl#L121-L160">source</a></section></article><h2 id="Error-Analysis"><a class="docs-heading-anchor" href="#Error-Analysis">Error Analysis</a><a id="Error-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Analysis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RobustGRAPE.calculate_fidelity_response" href="#RobustGRAPE.calculate_fidelity_response"><code>RobustGRAPE.calculate_fidelity_response</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_fidelity_response(fidelity_problem::FidelityRobustGRAPEProblem, x::Vector{&lt;:Real}, normalized_frequencies::Vector{&lt;:Real})</code></pre><p>Calculate the frequency-domain fidelity response function for error sources at specified frequencies.</p><p>The fidelity response function characterizes how sensitive the quantum gate is to noise at different  frequencies. This is crucial for understanding robustness against various noise spectra and can guide the design of control pulses that are specifically robust against the dominant noise frequencies in a particular experimental setup.</p><p><strong>Parameters</strong></p><ul><li><code>fidelity_problem::FidelityRobustGRAPEProblem</code>: The fidelity problem definition</li><li><code>x::Vector{&lt;:Real}</code>: The control parameters vector</li><li><code>normalized_frequencies::Vector{&lt;:Real}</code>: Normalized frequencies at which to evaluate the response function</li></ul><p><strong>Returns</strong></p><ul><li>A matrix of dimensions (nfreq, nerr) containing the fidelity response function values for each error  source at each frequency, where nfreq is the number of frequencies and nerr is the number of error sources.</li></ul><p><strong>Notes</strong></p><ul><li>Frequencies are normalized by Ω (the characteristic frequency of the system)</li><li>The response function is related to the error sensitivity: at zero frequency, the response function value is proportional to the static error sensitivity</li><li>Higher values indicate greater sensitivity to noise at that frequency</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/srtweezer/RobustGRAPE/blob/8de327b031e20102196b4646e4e74ba724094e52/src/FidelityCalculations.jl#L223-L247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RobustGRAPE.calculate_fidelity_response_fft" href="#RobustGRAPE.calculate_fidelity_response_fft"><code>RobustGRAPE.calculate_fidelity_response_fft</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_fidelity_response_fft(fidelity_problem::FidelityRobustGRAPEProblem, x::Vector{&lt;:Real}; oversampling::Int = 1)</code></pre><p>Calculate the frequency-domain fidelity response function using Fast Fourier Transform (FFT).</p><p>This function efficiently computes the frequency-domain fidelity response function for all error sources using FFT algorithms, which is computationally more efficient than direct calculation at specific frequencies. The implementation adds zero-padding to achieve frequency oversampling if requested.</p><p><strong>Parameters</strong></p><ul><li><code>fidelity_problem::FidelityRobustGRAPEProblem</code>: The fidelity problem definition</li><li><code>x::Vector{&lt;:Real}</code>: The control parameters vector</li><li><code>oversampling::Int = 1</code>: Oversampling factor to increase the resolution of the frequency response</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>response_fct_ω</code>: Matrix of dimensions (ntimes*oversampling, nerr) containing the fidelity  response function values for each frequency and error source</li><li><code>norm_frequencies</code>: Vector of normalized frequencies corresponding to the response function values</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Frequencies are normalized by the quantum system&#39;s characteristic energy scale</li><li>The oversampling parameter allows for higher frequency resolution by zero-padding in the time domain</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/srtweezer/RobustGRAPE/blob/8de327b031e20102196b4646e4e74ba724094e52/src/FidelityCalculations.jl#L284-L307">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RobustGRAPE.calculate_expectation_values" href="#RobustGRAPE.calculate_expectation_values"><code>RobustGRAPE.calculate_expectation_values</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_expectation_values(fidelity_problem::FidelityRobustGRAPEProblem, x::Vector{&lt;:Real})</code></pre><p>Calculate the time-dependent expectation values of error generators during the quantum evolution.</p><p>This function computes how the expectation values of the error generators evolve over time under the optimized control pulse sequence. This provides insight into how errors accumulate during the quantum gate implementation and can be used to visualize the error sensitivity profile over time.</p><p><strong>Parameters</strong></p><ul><li><code>fidelity_problem::FidelityRobustGRAPEProblem</code>: The fidelity problem definition</li><li><code>x::Vector{&lt;:Real}</code>: The control parameters vector</li></ul><p><strong>Returns</strong></p><ul><li>A matrix of dimensions (ntimes, nerr) containing the expectation values of each error operator at each time step of the evolution.</li></ul><p><strong>Notes</strong></p><ul><li>The calculation uses the cumulative sum of the interaction-picture error operators</li><li>Values are normalized by the dimension of the projector subspace</li><li>The time resolution is determined by the number of time steps in the problem definition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/srtweezer/RobustGRAPE/blob/8de327b031e20102196b4646e4e74ba724094e52/src/FidelityCalculations.jl#L347-L369">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../unitary/">« Unitary Calculations</a><a class="docs-footer-nextpage" href="../regularization/">Regularization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Tuesday 29 April 2025 00:14">Tuesday 29 April 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
